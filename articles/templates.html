<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rmd Templates • parsermd</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Rmd Templates">
<meta property="og:description" content="parsermd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parsermd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/parsermd.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/templates.html">Rmd Templates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="templates_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Rmd Templates</h1>
            
      
      
      <div class="hidden name"><code>templates.Rmd</code></div>

    </div>

    
    
<p>In the getting started vignette we introduced a variety of predicate functions for interrogating the contents of a parsed R Markdown document. The family of <code>rmd_has_*</code> functions give a convenient way of checking explicitly for elements of an Rmd, however often we want to check for multiple elements at the same time and provide consistent output for any detected discrepancies.</p>
<p>To support this type of workflow, <code>parsermd</code> implements the concept of an Rmd template. These are tibble based representations of Rmd elements which can be easily be compared with a parsed document.</p>
<div id="example---hw01" class="section level2">
<h2 class="hasAnchor">
<a href="#example---hw01" class="anchor"></a>Example - <code>hw01</code>
</h2>
<p>Imagine that a homework assignment has been distributed to students in the form of an Rmd document named <code>hw01.Rmd</code>. This document describes all of the necessary tasks for the student to complete and also includes scaffolding in the form of Rmd chunks and markdown that indicates where the students are expected to include their solutions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">rmd</span> <span class="op">=</span> <span class="fu"><a href="../reference/parse_rmd.html">parse_rmd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"hw01.Rmd"</span>, package <span class="op">=</span> <span class="st">"parsermd"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ├── YAML [2 lines]</span>
<span class="co">#&gt; ├── Heading [h3] - Load packages</span>
<span class="co">#&gt; │   └── Chunk [r, 1 opt, 2 lines] - load-packages</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 1</span>
<span class="co">#&gt; │   ├── Markdown [2 lines]</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       └── Markdown [2 lines]</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 2</span>
<span class="co">#&gt; │   ├── Markdown [2 lines]</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       ├── Markdown [4 lines]</span>
<span class="co">#&gt; │       ├── Chunk [r, 2 opts, 5 lines] - plot-dino</span>
<span class="co">#&gt; │       ├── Markdown [2 lines]</span>
<span class="co">#&gt; │       └── Chunk [r, 2 lines] - cor-dino</span>
<span class="co">#&gt; └── Heading [h3] - Exercise 3</span>
<span class="co">#&gt;     ├── Markdown [2 lines]</span>
<span class="co">#&gt;     └── Heading [h4] - Solution</span>
<span class="co">#&gt;         ├── Markdown [4 lines]</span>
<span class="co">#&gt;         ├── Chunk [r, 1 lines] - plot-star</span>
<span class="co">#&gt;         ├── Markdown [2 lines]</span>
<span class="co">#&gt;         └── Chunk [r, 1 lines] - cor-star</span></code></pre></div>
<p>We can see examples of this templating by extracting the contents of the markdown in the Exercise 1 &gt; Solution section.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmd_select.html">rmd_select</a></span><span class="op">(</span><span class="va">rmd</span>, <span class="fu"><a href="../reference/rmd_select_helpers.html">by_section</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exercise 1"</span>, <span class="st">"Solution"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/rmd_select_helpers.html">has_type</a></span><span class="op">(</span><span class="st">"rmd_markdown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_document.html">as_document</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "(Type your answer to Exercise 1 here. This exercise does not require any R code.)"</span>
<span class="co">#&gt; [2] ""                                                                                 </span>
<span class="co">#&gt; [3] ""</span></code></pre></div>
<p>When a student completes this assignment we want to be able to check that they have included solutions in the appropriate sections. At a minimum this means that we need to check that these sections still exist, and secondarily we might also want to check that the provided content in the solution differs from the provided scaffolding.</p>
<div id="constructing-a-template" class="section level3">
<h3 class="hasAnchor">
<a href="#constructing-a-template" class="anchor"></a>Constructing a template</h3>
<p>We will begin by subsetting the original parsed document to select only the elements that will contain the student’s answers - this assumes the other sections and elements are extraneous and contain things like background, instructions, and question text. Below we use <code>rmd_select</code> to select all of the elements of the original document contained withing a section matching "Exercise *" and “Solution” which should cover the answers for all three exercises.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">rmd_sols</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmd_select.html">rmd_select</a></span><span class="op">(</span><span class="va">rmd</span>, <span class="fu"><a href="../reference/rmd_select_helpers.html">by_section</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exercise *"</span>, <span class="st">"Solution"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 1</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       └── Markdown [2 lines]</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 2</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       ├── Markdown [4 lines]</span>
<span class="co">#&gt; │       ├── Chunk [r, 2 opts, 5 lines] - plot-dino</span>
<span class="co">#&gt; │       ├── Markdown [2 lines]</span>
<span class="co">#&gt; │       └── Chunk [r, 2 lines] - cor-dino</span>
<span class="co">#&gt; └── Heading [h3] - Exercise 3</span>
<span class="co">#&gt;     └── Heading [h4] - Solution</span>
<span class="co">#&gt;         ├── Markdown [4 lines]</span>
<span class="co">#&gt;         ├── Chunk [r, 1 lines] - plot-star</span>
<span class="co">#&gt;         ├── Markdown [2 lines]</span>
<span class="co">#&gt;         └── Chunk [r, 1 lines] - cor-star</span></code></pre></div>
<p>One we have this more limited set of elements we use the <code>rmd_template</code> function to generate our template. Here we have included <code>keep_content  = TRUE</code> in order to keep the scaffolded content for each answer which will then be compared to the student’s answers.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">rmd_tmpl</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmd_template.html">rmd_template</a></span><span class="op">(</span><span class="va">rmd_sols</span>, keep_content <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 5</span>
<span class="co">#&gt;   sec_h3    sec_h4  type     label   content                                    </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;                                      </span>
<span class="co">#&gt; 1 Exercise… Soluti… rmd_mar… &lt;NA&gt;    "(Type your answer to Exercise 1 here. Thi…</span>
<span class="co">#&gt; 2 Exercise… Soluti… rmd_mar… &lt;NA&gt;    "(The answers for this Exercise are given …</span>
<span class="co">#&gt; 3 Exercise… Soluti… rmd_chu… plot-d… "dino_data &lt;- datasaurus_dozen %&gt;%\n  filt…</span>
<span class="co">#&gt; 4 Exercise… Soluti… rmd_mar… &lt;NA&gt;    "And next calculate the correlation betwee…</span>
<span class="co">#&gt; 5 Exercise… Soluti… rmd_chu… cor-di… "dino_data %&gt;%\n  summarize(r = cor(x, y))"</span>
<span class="co">#&gt; 6 Exercise… Soluti… rmd_mar… &lt;NA&gt;    "(Add code and narrative as needed. Note t…</span>
<span class="co">#&gt; 7 Exercise… Soluti… rmd_chu… plot-s… ""                                         </span>
<span class="co">#&gt; 8 Exercise… Soluti… rmd_mar… &lt;NA&gt;    "I'm some text, you should replace me with…</span>
<span class="co">#&gt; 9 Exercise… Soluti… rmd_chu… cor-st… ""</span></code></pre></div>
</div>
<div id="using-a-template" class="section level3">
<h3 class="hasAnchor">
<a href="#using-a-template" class="anchor"></a>Using a template</h3>
<p>One the template is constructed we can then compare it with a new Rmd document via the <code>rmd_check_template</code> function. Note that we can pass in an <code>rmd_ast</code> or <code>rmd_tibble</code> object directly, or the path to an Rmd which will then be parsed and compared.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rmd_check_template.html">rmd_check_template</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"hw01-student.Rmd"</span>, package <span class="op">=</span> <span class="st">"parsermd"</span><span class="op">)</span>, <span class="va">rmd_tmpl</span><span class="op">)</span>
<span class="co">#&gt; ✖ The following required elements were missing in the document:</span>
<span class="co">#&gt;   • Section "Exercise 3" &gt; "Solution" is missing required 'markdown text'.</span>
<span class="co">#&gt;   • Section "Exercise 3" &gt; "Solution" is missing required 'markdown text'.</span>
<span class="co">#&gt; ✖ The following document elements were unmodified from the template:</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has a 'code chunk' named 'plot-dino'</span>
<span class="co">#&gt;     which has not been modified.</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has 'markdown text' which has not been</span>
<span class="co">#&gt;     modified.</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has a 'code chunk' named 'cor-dino'</span>
<span class="co">#&gt;     which has not been modified.</span></code></pre></div>
<p>From the output we can see that there are several issues with the document submitted by the student, they are missing the two expected markdown text entries for Exercise 3 and it appears that they have not entered any thing new for the chunks or markdown in Exercise 2.</p>
</div>
<div id="revising-a-template" class="section level3">
<h3 class="hasAnchor">
<a href="#revising-a-template" class="anchor"></a>Revising a template</h3>
<p>Let assume that our original template was a bit too strict, and we would like to revise the feedback it is giving to students.</p>
<p>If we were to decide that for Exercise 3 the markdown text was not actually necessary, we can remove this requirement by filtering those elements from <code>rmd_sols</code> or from <code>rmd_tmpl</code>. (Generally, the former is the suggetsed workflow and will always work, while the later approach is likely to be somewhat fragile to any changes made to the template format in future releases.) Here we use <code>rmd_select</code> with the <code><a href="https://rdrr.io/r/base/Logic.html">!</a></code> operator to remove these specific markdown elements.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmd_sols</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmd_select.html">rmd_select</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="../reference/rmd_select_helpers.html">by_section</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exercise 3"</span>, <span class="st">"Solution"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/rmd_select_helpers.html">has_type</a></span><span class="op">(</span><span class="st">"rmd_markdown"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 1</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       └── Markdown [2 lines]</span>
<span class="co">#&gt; ├── Heading [h3] - Exercise 2</span>
<span class="co">#&gt; │   └── Heading [h4] - Solution</span>
<span class="co">#&gt; │       ├── Markdown [4 lines]</span>
<span class="co">#&gt; │       ├── Chunk [r, 2 opts, 5 lines] - plot-dino</span>
<span class="co">#&gt; │       ├── Markdown [2 lines]</span>
<span class="co">#&gt; │       └── Chunk [r, 2 lines] - cor-dino</span>
<span class="co">#&gt; └── Heading [h3] - Exercise 3</span>
<span class="co">#&gt;     └── Heading [h4] - Solution</span>
<span class="co">#&gt;         ├── Chunk [r, 1 lines] - plot-star</span>
<span class="co">#&gt;         └── Chunk [r, 1 lines] - cor-star</span></code></pre></div>
<p>This new AST can then be passed to <code>rmd_template</code> and <code>rmd_check_template</code> to provide the revised feedback,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmd_sols</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmd_select.html">rmd_select</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="../reference/rmd_select_helpers.html">by_section</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Exercise 3"</span>, <span class="st">"Solution"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/rmd_select_helpers.html">has_type</a></span><span class="op">(</span><span class="st">"rmd_markdown"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmd_template.html">rmd_template</a></span><span class="op">(</span>keep_content <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rmd_check_template.html">rmd_check_template</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"hw01-student.Rmd"</span>, package <span class="op">=</span> <span class="st">"parsermd"</span><span class="op">)</span>, <span class="va">.</span><span class="op">)</span>
<span class="co">#&gt; ✖ The following document elements were unmodified from the template:</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has a 'code chunk' named 'plot-dino'</span>
<span class="co">#&gt;     which has not been modified.</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has 'markdown text' which has not been</span>
<span class="co">#&gt;     modified.</span>
<span class="co">#&gt;   • Section "Exercise 2" &gt; "Solution" has a 'code chunk' named 'cor-dino'</span>
<span class="co">#&gt;     which has not been modified.</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Colin Rundel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
